# Microsoft Visual FoxPro 6.0 数据库百科

## **VFP是个啥？**

1. ### VFP的基础概念

   VFP是一款基于Windows操作系统的关系型数据库管理软件，具有快速开发、易学易用、灵活性强等特点。VFP的版本包括VFP 6.0、VFP 7.0、VFP 8.0、VFP 9.0等。VFP的应用领域主要包括数据库应用、企业管理、财务管理、电子商务等方面。VFP的开发环境包括VFP IDE、VFP运行库、VFP框架等。

2. ### VFP的语法

   VFP的数据类型包括字符型、数值型、逻辑型、日期型、对象型等。VFP的变量包括局部变量、全局变量、公共变量等。VFP的常量包括数字常量、字符串常量、日期常量、空值常量等。VFP的运算符包括算术运算符、比较运算符、逻辑运算符、位运算符等。VFP的表达式包括算术表达式、逻辑表达式、字符串表达式等。VFP的控制语句包括条件语句、循环语句、跳转语句等。VFP的函数包括字符串函数、数学函数、日期函数、系统函数、文件函数、数据库函数等。

3. ### VFP的命令

   VFP的文件操作命令包括CREATE、USE、CLOSE、DELETE、RENAME等。VFP的表格操作命令包括APPEND、EDIT、DELETE、PACK、INDEX等。VFP的表单操作命令包括CREATE FORM、MODIFY FORM、DESTROY FORM等。VFP的报表操作命令包括REPORT FORM、MODIFY REPORT、DESTROY REPORT等。VFP的程序控制命令包括DO、DO WHILE、RETURN、QUIT等。

4. ### VFP的函数

   VFP的字符串函数包括LEN、LTRIM、RTRIM、ALLTRIM、SUBSTR等。VFP的数学函数包括ABS、CEILING、FLOOR、ROUND、SIN、COS等。VFP的日期函数包括DATE、TIME、YEAR、MONTH、DAY、HOUR、MINUTE、SECOND等。VFP的系统函数包括MESSAGEBOX、PROMPT、GETFILE、GETDIR等。VFP的文件函数包括FILE、FOPEN、FCLOSE、FGETS、FPUTS等。VFP的数据库函数包括SELECT、INSERT、UPDATE、DELETE、APPEND等。

5. ### VFP的面向对象编程

   VFP的类是一种封装数据和方法的数据类型，可以通过实例化创建对象。VFP的对象是类的实例，可以调用类的方法和属性。VFP的方法是类的成员函数，用于处理对象的数据和行为。VFP的事件是类的响应函数，用于处理对象的事件。

6. ### VFP的数据库编程

   VFP的表格操作包括CREATE TABLE、ALTER TABLE、DROP TABLE等。VFP的查询包括SELECT、FROM、WHERE、GROUP BY、HAVING、ORDER BY等。VFP的索引包括PRIMARY KEY、UNIQUE、INDEX等。VFP的关系包括一对一关系、一对多关系、多对多关系等。VFP的视图是一种虚拟表格，可以从一个或多个表格中选择数据。VFP的存储过程是一种预定义的操作序列，可以重复调用。VFP的触发器是一种在表格上定义的事件，当表格中的数据发生改变时，触发器会自动执行相应的操作。

7. ### VFP的图形用户界面

   VFP的表单是一种窗体，用于显示和编辑数据。VFP的报表是一种用于打印数据的格式化输出。VFP的控件包括按钮、文本框、列表框、下拉框、复选框、单选框等。VFP的菜单是一种用于快速访问功能的导航栏。VFP的工具栏是一种快速访问常用操作的工具条。VFP的状态栏是一种显示状态信息的栏目。

8. ### VFP的调试和错误处理

   VFP的调试器可以用于调试程序，包括断点、单步执行、变量监视等功能。VFP的错误处理器可以用于捕获和处理程序中的错误，包括TRY…CATCH、ON ERROR等语句。VFP的日志文件可以用于记录程序运行时的操作和错误信息。

9. ### VFP的高级编程技巧

   VFP的多线程编程可以用于提高程序的效率，包括THREAD、WAIT、RELEASE等语句。VFP的COM编程可以用于与其他应用程序进行交互，包括CREATEOBJECT、RELEASEOBJECT等语句。VFP的XML编程可以用于处理XML格式的数据，包括XMLTOCURSOR、CURSORTOXML等语句。VFP的Web编程可以用于开发网站和Web应用程序，包括WEBFORM、WEBTEXTBOX等控件。

   ## **VFP的基础内容**

> ### **数据类型测试函数返回字母**

|            数据类型            | 返回字母 |  数据类型  | 返回字母 |
| :----------------------------: | :------: | :--------: | :------: |
|             字符型             |    C     |   通用型   |    G     |
| 数值型、整形、浮点型、双精度型 |    N     |   日期型   |    D     |
|             货币型             |    Y     | 日期时间型 |    T     |
|             逻辑型             |    L     |   备注型   |    M     |
|             对象型             |    O     |   未定义   |    U     |

> ### **算数运算符**

| 运算符  |      功能      |    表达式举例    | 运算结果 | 优先级别 |
| :-----: | :------------: | :--------------: | :------: | :------: |
|   ()    |     圆括号     |   (2-5)*(3+2)    |   -15    |    5     |
|  -、+   |     正负号     |       -3^2       |    9     |    4     |
|  **、^  |      乘幂      |    2**5、3^2     |  32、9   |    3     |
| *、/、% | 乘、除、取余数 | 2*10、25/5、21%5 | 20、5、1 |    2     |
|  +、-   |     加、减     |   36+19、29-47   | 55、-18  |    1     |

> ### 字符运算符

| 运算符 |                   功能                    |            表达式举例             |   运算结果   |
| :----: | :---------------------------------------: | :-------------------------------: | :----------: |
|   +    |         串 1+串 2:两串顺序相连接          |           '12   '+'56'            |  '12   56'   |
|   -    | 串 1-串 2:串1尾空格移到串 2尾后再顺序连接 |             '12'-'56'             |    '1256'    |
|   $    |        串1$ 串2:串1是否为串 2子串         | '1234'$'12345'<br/>'1234'$'34512' | .T.<br />.F. |



# **字典**

> ## 符号
>

### &

**连接、宏替换**

1. 字符串连接符：&符号可以用于连接两个字符串，例如：

   ```
   ? "Hello" & " " & "World"   && 输出 "Hello World"
   ```

   在这个例子中，&符号用于连接三个字符串，将它们拼接成一个新的字符串。

2. 宏替换符号：&符号还可以用于宏替换，即将宏变量替换为其对应的值，例如：

   ```
   ? &MyVar   && 输出宏变量MyVar的值
   ```

   在这个例子中，&符号用于宏替换，将宏变量MyVar替换为其对应的值。需要注意的是，在使用宏替换时，宏变量需要先被定义和赋值。

需要注意的是，VFP中的&符号和一些其他编程语言中的&符号有所不同，不要混淆。

### ()

**传入参数、数组下标、表达式优先级**

1. 函数调用：函数名后面跟一对圆括号，表示调用该函数并传入参数。例如：

   ```
   ? UPPER("hello")   && 输出 "HELLO"
   ```

2. 数组下标：数组名后面跟一对方括号[]，方括号内写下标值，表示访问该数组的指定元素。在VFP中，方括号也可以用圆括号代替，例如：

   ```
   DIM arr(5)
   arr[1] = 10
   ? arr(1)   && 输出 10
   ```

3. 表达式优先级：圆括号可以改变表达式中运算符的优先级，使得括号中的表达式先于其他运算进行计算。例如：

   ```
   ? 2*3+(4-1)   && 输出 9
   ? 2*(3+4)-1   && 输出 13
   ```

需要注意的是，圆括号必须成对出现，且左右括号的数量要相等，否则会导致语法错误。

### +

**数值相加、字符串连接**

1. 对于数值类型的数据，"+"表示相加运算，例如：

   ```
   ? 2+3   && 输出5
   ```

2. 对于字符类型的数据，"+"表示连接运算，例如：

   ```
   ? "Hello"+" "+"World"   && 输出 "Hello World"
   ```

需要注意的是，在字符连接时，"+"运算符只能用于连接两个字符型的字母串，如果其中一个操作数是数值类型，则需要先将其转换为字符类型。例如：

```
? "Price: "+STR(100)+" USD"   && 输出 "Price: 100 USD"
```

在此例中，使用了STR()函数将数值类型的100转换为字符类型的"100"，然后再与其他字符型的字母串进行连接。

### -

**数值相减、取反运算、字符串连接**

1. 数值相减：表示两个数值相减的运算符，例如：

   ```
   ? 5-2   && 输出 3
   ```

2. 取反运算：表示对数值进行取反运算，例如：

   ```
   ? -5   && 输出 -5
   ? -(-5)   && 输出 5
   ```

3. 字符串连接：在字符串连接中，减号可以用于去除字符串中的空格或特定字符，例如：

   ```
   ? " Hello, World! "-","   && 输出 "Hello World!"
   ```

在此例中，使用减号"-“将原始字符串中的空格和逗号去除掉，只留下单词"Hello"和"World”。需要注意的是，在字符串连接中，减号只能用于去除指定字符，不能用于连接字符串，如果需要连接字符串应该使用加号"+"。



### **、^

**乘幂**

1. "**"运算符：表示数字的n次方，其中n是另一个数字。例如：

   ```
   ? 2**3   && 输出8，即2的3次方
   ? 4**0.5   && 输出2，即4的平方根
   ```

2. "^"运算符：表示字符串的重复，其中左侧是要重复的字符串，右侧是要重复的次数。例如：

   ```
   ? "abc"^3   && 输出 "abcabcabc"
   ? "hello "^2+"world"   && 输出 "hello hello world"
   ```

需要注意的是，"**“和”^"运算符的优先级比加减乘除运算符高，如果表达式中同时出现多种运算符，应该根据需要使用圆括号来明确优先级。

### *

**数值相乘、字符重复**

1. 数值相乘：表示两个数值相乘的运算符，例如：

   ```
   ? 2*3   && 输出 6
   ```

2. 字符重复：表示重复字符的运算符，其中左侧是要重复的字符，右侧是要重复的次数。例如：

   ```
   ? "-"*10   && 输出 "----------"
   ? "abc"*3   && 输出 "abcabcabc"
   ```

需要注意的是，星号"*"运算符的优先级比加减运算符高，但比乘方运算符低，如果表达式中同时出现多种运算符，应该根据需要使用圆括号来明确优先级

### /

**数值相除、字符串分割**

1. 数值相除：表示两个数值相除的运算符，例如：

   ```
   ? 6/2   && 输出 3
   ? 5/2   && 输出 2.5
   ```

需要注意的是，如果除数为0，会产生除以0的异常错误。

1. 字符串分割：在字符串处理中，斜杠"/"通常用于字符串分割，例如：

   ```
   ? STRTRAN("Hello/World","/"," ")   && 输出 "Hello World"
   ```

在此例中，使用STRTRAN()函数将原始字符串中的斜杠"/“替换为空格” "，实现字符串的分割操作。

需要注意的是，斜杠"/"运算符的优先级比加减运算符高，但比乘除运算符低，如果表达式中同时出现多种运算符，应该根据需要使用圆括号来明确优先级。

### %

**取余数**

取余运算符，也称为模运算符。取余运算符用于计算两个整数相除的余数，例如：

```
? 5%2   && 输出 1，即5除以2的余数
```

需要注意的是，取余运算符只适用于整数值，如果其中一个操作数为浮点数，则会自动向下取整。例如：

```
? 5.9%2   && 输出 1，即5除以2的余数
```

另外，如果除数为0，会产生除以0的异常错误。

### $

**判断左边的字符串是否为右边的字符串**

### ！

**逻辑非**

### <>、#、！=

**不等于**

> ## A
>

### ABS()

**绝对值函数**

Visual FoxPro (VFP) 中，ABS 函数的作用也是返回一个数的绝对值，即该数的大小，而不考虑它的符号（正负号）。

在 VFP 中，ABS 函数的语法如下：

```
ABS(nValue)
```

其中，nValue 是要计算绝对值的数值参数。ABS 函数将返回该参数的绝对值。

例如，以下代码演示了如何使用 ABS 函数来计算一个数的绝对值：

```
nValue = -10
? ABS(nValue)   && 输出结果为 10
```

在 VFP 中，ABS 函数还可以用于计算复数的模长（即绝对值）。例如，以下代码演示了如何使用 ABS 函数来计算一个复数的模长：

```
nComplex = 3 + 4*I   && 定义一个复数
? ABS(nComplex)   && 输出结果为 5
```

总之，ABS 函数在 VFP 中的作用与其他编程语言中的作用类似，都是计算一个数的绝对值。在 VFP 中，ABS 函数还可以用于计算复数的模长。

### ASC

**数值转换为ASCII码**

语法如下：

```vfp
ASC(cExpression)
```

其中，cExpression表示要获取ASCII码值的字符表达式。

以下是一个示例：

```vfp
cChar = "A"
nAscii = ASC(cChar)
```

在上述示例中，cChar的值为"A"，我们使用ASC函数获取它的ASCII码值。因此，nAscii的值将为65。

ASC函数返回一个整数值，表示给定字符的ASCII码值。ASCII码是一种将字符映射为数字的编码系统，每个字符都有一个对应的唯一的ASCII码值。

ASC函数在处理字符时非常有用，可以用于字符的比较、排序以及其他需要基于字符的操作。

### AT()

**从一个字符串查另一个字符串位置**

函数的语法如下：

```
AT(cSubstr, cString [, nStart])
```

其中，cSubstr表示要查找的子串，cString表示要查找的字符串，nStart表示查找的起始位置，如果省略nStart，则默认从字符串的第一个字符开始查找。

例如：

```
? AT("World", "Hello World")   && 输出 7，查找"World"在"Hello World"中的位置
? AT("World", "Hello World", 8)   && 输出 0，从第8个字符开始查找，找不到返回0
```

需要注意的是，如果在字符串中找不到子串，则AT()函数会返回0。另外，AT()函数是区分大小写的，如果要进行不区分大小写的查找，可以使用ATC()函数。

ATC()函数的语法和AT()函数类似，只是它是不区分大小写的，例如：

```
? ATC("world", "Hello World")   && 输出 7，不区分大小写地查找"world"在"Hello World"中的位置
```

需要注意的是，ATC()函数的性能比AT()函数差，因为它需要进行字符串的转换和比较。

### ALLT

**去除字符串中的尾随空格**

语法如下：

```vfp
ALLT(cExpression)
```

其中，cExpression表示要处理的字符串表达式。

ALLT函数会将输入字符串中的尾随空格去除，并返回处理后的字符串。如果字符串中没有尾随空格，则返回原始字符串。

以下是一个示例：

```vfp
cString = "Hello World!     "
cTrimmedString = ALLT(cString)
```

在上述示例中，cString的值为"Hello World! "，包含多个尾随空格。使用ALLT函数对cString进行处理后，cTrimmedString的值将变为"Hello World!"，即去除了尾随空格的字符串。

ALLT函数常用于处理用户输入或从数据库中读取的字符串，以确保数据的一致性和准确性。

> ## B

### BEWTEEN

**逻辑运算符，判断一个值是否在两个给定的值之间**

其语法如下：

```vfp
value BETWEEN startValue AND endValue
```

其中，value表示要判断的值，startValue和endValue分别表示范围的起始值和结束值。

BEWTEEN运算符的使用可以用于条件判断或筛选数据。例如，可以使用如下语句筛选出年龄在20到30之间的人：

```vfp
SELECT * FROM myTable WHERE age BETWEEN 20 AND 30
```

上述语句将返回myTable表中年龄在20到30之间的记录。



> ## C

### CHR

**ASCII码值转换为对应的字符**

语法如下：

```vfp
CHR(nAscii)
```

其中，nAscii表示要转换为字符的ASCII码值。

以下是一个示例：

```vfp
nAscii = 65
cChar = CHR(nAscii)
```

在上述示例中，nAscii的值为65，我们使用CHR函数将其转换为对应的字符。因此，cChar的值将为"A"。

CHR函数将给定的ASCII码值转换为对应的字符，并返回字符表达式。ASCII码是一种将字符映射为数字的编码系统，每个字符都有一个对应的唯一的ASCII码值。

CHR函数在处理字符编码时非常有用，可以用于生成特定ASCII码值的字符，或者将数字转换为对应的字符形式。



> ## D



> ## E
>

> ## F
>

> ## G
>

> ## H
>

> ## I
>

### INT()

**向低取整**

INT 函数的作用是返回一个数的整数部分，即舍弃小数部分后的整数。INT 函数将对参数进行截断（truncate）处理，将小数部分舍去，只保留整数部分。

INT 函数的语法如下：

```
INT(nValue)
```

其中，nValue 是要取整的数值参数。INT 函数将返回该参数的整数部分。

例如，以下代码演示了如何使用 INT 函数来取整：

```
? INT(3.14)    && 输出结果为 3
? INT(-3.14)   && 输出结果为 -3
```

需要注意的是，INT 函数返回的结果与参数的正负有关。对于正数的参数，INT 函数将直接截取整数部分；对于负数的参数，INT 函数将将小数部分向下取整，即保留绝对值较大的整数。例如，INT(-3.14) 的结果是 -3，而不是 -4。

此外，在 VFP 中，如果参数为 NULL，则 INT 函数将返回 NULL。

总之，INT 函数在 VFP 中的作用是返回一个数的整数部分，即舍弃小数部分后的整数。它可以用于将一个浮点数截断为整数，并且可以对正数和负数进行处理。如果您需要对浮点数进行取整操作，可以使用 INT 函数来实现。

> ## J
>

> ## K
>

> ## L

### LEN()

**字符串长度**

函数的语法如下：

```
LEN(cString)
```

其中，cString表示要计算长度的字符串。

例如：

```
? LEN("Hello World")   && 输出 11，计算"Hello World"字符串的长度
? LEN("")   && 输出 0，计算空字符串的长度
```

需要注意的是，如果cString参数不是一个字符串，而是一个数字或其他类型的数据，LEN()函数会将其转换为字符串后再计算长度。如果cString参数为NULL，则LEN()函数会返回空值NULL。

另外，VFP中还有一个类似的函数叫做EMPTY()，它用于判断一个表达式是否为空。如果表达式的值为NULL、空字符串或空数组，则EMPTY()函数返回逻辑值.TRUE.，否则返回逻辑值.FALSE.。例如：

```
? EMPTY("")   && 输出 .T.，判断空字符串是否为空
? EMPTY(0)   && 输出 .F.，数字0不为空
? EMPTY(NULL)   && 输出 .T.，空值NULL为空
```

> ## M
>

> ## N
>

> ## O
>

> ## P
>

> ## Q
>

> ## R

### ROUND()

**四舍五入**

函数的语法如下：

```
ROUND(nExpression [, nDecimals])
```

其中，nExpression表示要进行四舍五入的数值表达式，nDecimals表示要保留的小数位数，默认值为0。

例如：

```
? ROUND(1.2345)   && 输出 1，将1.2345四舍五入到整数
? ROUND(1.2345, 2)   && 输出 1.23，将1.2345四舍五入到2位小数
? ROUND(12345, -2)   && 输出 12300，将12345四舍五入到百位
```

需要注意的是，ROUND()函数的舍入规则是根据数值的小数部分进行的，如果小数部分大于等于0.5，则舍入到更大的数，否则舍入到更小的数。如果要对负数进行舍入操作，可以使用ROUND()函数的第三个参数，例如：

```
? ROUND(-1.2345, 2, 1)   && 输出 -1.23，将-1.2345四舍五入到2位小数，并保留负号
```

在这个例子中，ROUND()函数的第三个参数为1，表示保留负号。





> ## S

### SQRT()

**算数平方根**

函数的语法如下：

```
SQRT(nExpression)
```

其中，nExpression表示要计算平方根的数值表达式。

例如：

```
? SQRT(4)   && 输出 2，计算4的平方根
? SQRT(2)   && 输出 1.41421356，计算2的平方根
```

需要注意的是，如果nExpression小于0，则SQRT()函数会返回空值NULL。如果要计算复数的平方根，可以使用COMPLEX()函数。



### SUBSTR()

**从一个字符串里第几个开始取几个**

函数的语法如下：

```
SUBSTR(cString, nStart [, nCount])
```

其中，cString表示要提取子串的字符串，nStart表示子串的起始位置（从1开始），nCount表示要提取的字符数。如果省略nCount，则默认提取从nStart开始到字符串结尾的所有字符。

例如：

```
? SUBSTR("Hello World", 7)   && 输出 "World"，提取从第7个字符开始到字符串结尾的所有字符
? SUBSTR("Hello World", 7, 3)   && 输出 "Wor"，提取从第7个字符开始的3个字符
```

需要注意的是，如果nStart小于1或大于字符串长度，则SUBSTR()函数会返回空字符串"“。如果nCount小于0，则SUBSTR()函数会返回空字符串”"或抛出异常，具体取决于VFP的版本和设置。

另外，需要注意的是，VFP中还有一个类似的函数叫做STRTRAN()，它可以在一个字符串中替换一个子串为另一个子串。STRTRAN()函数的语法如下：

```
STRTRAN(cString, cOldSubstr, cNewSubstr)
```

其中，cString表示要替换子串的字符串，cOldSubstr表示要被替换的子串，cNewSubstr表示替换后的子串。

例如：

```
? STRTRAN("Hello World", "World", "VFP")   && 输出 "Hello VFP"，将"Hello World"中的"World"替换为"VFP"
```

> ## T
>

> ## U

### UPPER

**将字符串转换为大写**

语法如下：

```vfp
UPPER(cExpression)
```

其中，cExpression表示要转换为大写的字符串表达式。

以下是一个示例：

```vfp
cString = "Hello World!"
cUpperCase = UPPER(cString)
```

在上述示例中，cString的值为"Hello World!"，我们使用UPPER函数将其转换为大写。因此，cUpperCase的值将为"HELLO WORLD!"。

UPPER函数将字符串中的所有字母都转换为大写形式，并返回转换后的字符串。如果字符串中包含非字母字符，它们将保持不变。

UPPER函数常用于对字符串进行大小写不敏感的比较或匹配，以及统一格式化字符串的需求。

如果在UPPER函数的括号内输入的是数值，VFP会将数值先转换为字符串，然后再将字符串转换为大写形式。例如：

```vfp
vfpnNumber = 12345
cUpperCase = UPPER(nNumber)
```

在上述示例中，nNumber的值为12345，它是一个数值类型。当我们将nNumber作为参数传递给UPPER函数时，VFP会将其先转换为字符串"12345"，然后再将该字符串转换为大写形式。因此，cUpperCase的值将为"12345"。

需要注意的是，如果在UPPER函数的括号内输入的是一个非数值的表达式，VFP会在运行时抛出错误。因此，确保在使用UPPER函数时，括号内输入的是一个合法的字符串表达式或变量。

> ## V
>

> ## W
>

> ## X
>

> ## Y
>

> ## Z
